import pandas as pd
df = pd.read_csv("house_data.csv")
df.head()

df.shape

all_features = ["bedrooms","bathrooms","sqft_living","floors","yr_built","sqft_above","sqft_basement","view","condition","grade", 
    "sqft_lot","waterfront","yr_renovated","zipcode"]

X_full = df[all_features]
y_full = df["price"]

from sklearn.feature_selection import SelectKBest, f_regression
selector = SelectKBest(score_func=f_regression, k=5)
selector.fit(X_full, y_full)

mask = selector.get_support()

mask

top5 = X_full.columns[mask].tolist()

top5

X_selected = X_full[top5]

X_selected.head()

X_train, X_test, y_train, y_test = train_test_split(X_selected, y_full, test_size=0.20, random_state=42)

print("Train shape:", X_train.shape, "Test shape:", X_test.shape)

model = LinearRegression()
model.fit(X_train, y_train)

coef_df = pd.DataFrame({
    "Feature": top5,
    "Coefficient": model.coef_
})
print(coef_df)
print("Intercept:", model.intercept_)

y_pred = model.predict(X_test)
print(y_pred)


import pandas as pd
import numpy as np

selected_features = ['bathrooms', 'sqft_living', 'sqft_above', 'view', 'grade']

new_df = pd.DataFrame([
    {'grade': 8, 'view': 1, 'bathrooms': 2.0, 'sqft_above': 1500, 'sqft_living': 1800},
    
])

X_new = new_df[selected_features]

X_new_array = X_new.to_numpy()   

predictions = model.predict(X_new_array)

new_df['predicted_price'] = predictions
print(new_df)

from sklearn.metrics import mean_squared_error, mean_absolute_error, r2_score
mse = mean_squared_error(y_test, y_pred)
print("Mean Squared Error (MSE):", mse)

rmse = np.sqrt(mse)
mae = mean_absolute_error(y_test, y_pred)
mape = np.mean(np.abs((y_test - y_pred) / y_test)) * 100
r2 = r2_score(y_test, y_pred)
n = X_test.shape[0]
k = X_test.shape[1]
adjusted_r2 = 1 - (1 - r2) * (n - 1) / (n - k - 1)

print("Root Mean Squared Error (RMSE):", rmse)
print("Mean Absolute Error (MAE):", mae)
print("Mean Absolute Percentage Error (MAPE):", mape)
print("R2 Score:", r2)
print("Adjusted R2 Score:", adjusted_r2)

import matplotlib.pyplot as plt
plt.figure(figsize=(16,9))
plt.subplot(221)
plt.title('bathrooms vs price')
plt.xlabel('bathrooms')
plt.ylabel('price')
plt.scatter(X_full['bathrooms'], y_full, color = 'r')

import matplotlib.pyplot as plt
plt.figure(figsize=(16,9))
plt.subplot(221)
plt.title('sqft_living vs price')
plt.xlabel('sqft_living')
plt.ylabel('price')
plt.scatter(X_full['sqft_living'], y_full, color = 'y')